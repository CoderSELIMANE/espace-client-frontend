{"ast":null,"code":"import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{useApp}from'../contexts/AppContext';import authService from'../services/authService';/**\n * Hook personnalisé pour gérer l'authentification\n * Assure que l'utilisateur est connecté et charge ses données\n */const useAuth=function(){let redirectTo=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'/login';const[isLoading,setIsLoading]=useState(true);const[isAuthenticated,setIsAuthenticated]=useState(false);const{state,actions}=useApp();const navigate=useNavigate();useEffect(()=>{const checkAuth=async()=>{try{setIsLoading(true);// Vérifier si l'utilisateur est authentifié\nif(!authService.isAuthenticated()){setIsAuthenticated(false);navigate(redirectTo);return;}setIsAuthenticated(true);// Si pas d'utilisateur dans le state, le charger\nif(!state.user){try{await actions.loadUser();}catch(error){console.error('Erreur lors du chargement de l\\'utilisateur:',error);// Si le chargement échoue, vérifier à nouveau l'authentification\nif(!authService.isAuthenticated()){setIsAuthenticated(false);navigate(redirectTo);return;}}}}catch(error){console.error('Erreur lors de la vérification d\\'authentification:',error);setIsAuthenticated(false);navigate(redirectTo);}finally{setIsLoading(false);}};checkAuth();},[navigate,redirectTo,actions,state.user]);return{isLoading,isAuthenticated,user:state.user};};export default useAuth;","map":{"version":3,"names":["useEffect","useState","useNavigate","useApp","authService","useAuth","redirectTo","arguments","length","undefined","isLoading","setIsLoading","isAuthenticated","setIsAuthenticated","state","actions","navigate","checkAuth","user","loadUser","error","console"],"sources":["C:/Users/PC/Desktop/modifier/Gestion_bibliotheque/espace_client_app/frontend/src/hooks/useAuth.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useApp } from '../contexts/AppContext';\nimport authService from '../services/authService';\n\n/**\n * Hook personnalisé pour gérer l'authentification\n * Assure que l'utilisateur est connecté et charge ses données\n */\nconst useAuth = (redirectTo = '/login') => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const { state, actions } = useApp();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        setIsLoading(true);\n\n        // Vérifier si l'utilisateur est authentifié\n        if (!authService.isAuthenticated()) {\n          setIsAuthenticated(false);\n          navigate(redirectTo);\n          return;\n        }\n\n        setIsAuthenticated(true);\n\n        // Si pas d'utilisateur dans le state, le charger\n        if (!state.user) {\n          try {\n            await actions.loadUser();\n          } catch (error) {\n            console.error('Erreur lors du chargement de l\\'utilisateur:', error);\n            // Si le chargement échoue, vérifier à nouveau l'authentification\n            if (!authService.isAuthenticated()) {\n              setIsAuthenticated(false);\n              navigate(redirectTo);\n              return;\n            }\n          }\n        }\n\n      } catch (error) {\n        console.error('Erreur lors de la vérification d\\'authentification:', error);\n        setIsAuthenticated(false);\n        navigate(redirectTo);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    checkAuth();\n  }, [navigate, redirectTo, actions, state.user]);\n\n  return {\n    isLoading,\n    isAuthenticated,\n    user: state.user\n  };\n};\n\nexport default useAuth;\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,MAAM,KAAQ,wBAAwB,CAC/C,MAAO,CAAAC,WAAW,KAAM,yBAAyB,CAEjD;AACA;AACA;AACA,GACA,KAAM,CAAAC,OAAO,CAAG,QAAAA,CAAA,CAA2B,IAA1B,CAAAC,UAAU,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,QAAQ,CACpC,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACW,eAAe,CAAEC,kBAAkB,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAAEa,KAAK,CAAEC,OAAQ,CAAC,CAAGZ,MAAM,CAAC,CAAC,CACnC,KAAM,CAAAa,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACFN,YAAY,CAAC,IAAI,CAAC,CAElB;AACA,GAAI,CAACP,WAAW,CAACQ,eAAe,CAAC,CAAC,CAAE,CAClCC,kBAAkB,CAAC,KAAK,CAAC,CACzBG,QAAQ,CAACV,UAAU,CAAC,CACpB,OACF,CAEAO,kBAAkB,CAAC,IAAI,CAAC,CAExB;AACA,GAAI,CAACC,KAAK,CAACI,IAAI,CAAE,CACf,GAAI,CACF,KAAM,CAAAH,OAAO,CAACI,QAAQ,CAAC,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,8CAA8C,CAAEA,KAAK,CAAC,CACpE;AACA,GAAI,CAAChB,WAAW,CAACQ,eAAe,CAAC,CAAC,CAAE,CAClCC,kBAAkB,CAAC,KAAK,CAAC,CACzBG,QAAQ,CAACV,UAAU,CAAC,CACpB,OACF,CACF,CACF,CAEF,CAAE,MAAOc,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qDAAqD,CAAEA,KAAK,CAAC,CAC3EP,kBAAkB,CAAC,KAAK,CAAC,CACzBG,QAAQ,CAACV,UAAU,CAAC,CACtB,CAAC,OAAS,CACRK,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAEDM,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACD,QAAQ,CAAEV,UAAU,CAAES,OAAO,CAAED,KAAK,CAACI,IAAI,CAAC,CAAC,CAE/C,MAAO,CACLR,SAAS,CACTE,eAAe,CACfM,IAAI,CAAEJ,KAAK,CAACI,IACd,CAAC,CACH,CAAC,CAED,cAAe,CAAAb,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}