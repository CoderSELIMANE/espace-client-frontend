{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import authService from'../services/authService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Login=()=>{const[formData,setFormData]=useState({email:'',password:''});const[loading,setLoading]=useState(false);const[error,setError]=useState('');const navigate=useNavigate();useEffect(()=>{// Rediriger si déjà connecté\nif(authService.isAuthenticated()){navigate('/dashboard');}},[navigate]);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});// Effacer l'erreur quand l'utilisateur tape\nif(error)setError('');};const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');try{console.log('Tentative de connexion avec:',formData.email);const response=await authService.login(formData.email,formData.password);if(response.success){console.log('Connexion réussie, redirection vers dashboard');navigate('/dashboard');}else{console.log('Échec de connexion:',response.message);setError(response.message||'Erreur de connexion');}}catch(err){var _err$non_field_errors;console.error('Erreur lors de la connexion:',err);setError(((_err$non_field_errors=err.non_field_errors)===null||_err$non_field_errors===void 0?void 0:_err$non_field_errors[0])||err.detail||err.message||'Erreur de connexion');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-vh-100 d-flex align-items-center bg-light\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-lg-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card shadow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"card-title\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-circle text-primary me-2\"}),\"Connexion\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Acc\\xE9dez \\xE0 votre espace client\"})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle me-2\"}),error]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"email\",className:\"form-label\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-envelope me-2\"}),\"Email\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",id:\"email\",name:\"email\",value:formData.email,onChange:handleChange,required:true,placeholder:\"votre@email.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",className:\"form-label\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lock me-2\"}),\"Mot de passe\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",name:\"password\",value:formData.password,onChange:handleChange,required:true,placeholder:\"Votre mot de passe\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary w-100 mb-3\",disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Connexion...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sign-in-alt me-2\"}),\"Se connecter\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"Pas encore de compte ?\",' ',/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"text-decoration-none\",children:\"S'inscrire\"})]})})]})})})})})});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","authService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","formData","setFormData","email","password","loading","setLoading","error","setError","navigate","isAuthenticated","handleChange","e","target","name","value","handleSubmit","preventDefault","console","log","response","login","success","message","err","_err$non_field_errors","non_field_errors","detail","className","children","role","onSubmit","htmlFor","type","id","onChange","required","placeholder","disabled","to"],"sources":["C:/Users/PC/Desktop/modifier/Gestion_bibliotheque/espace_client_app/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport authService from '../services/authService';\n\nconst Login = () => {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Rediriger si déjà connecté\n    if (authService.isAuthenticated()) {\n      navigate('/dashboard');\n    }\n  }, [navigate]);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n    // Effacer l'erreur quand l'utilisateur tape\n    if (error) setError('');\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      console.log('Tentative de connexion avec:', formData.email);\n      const response = await authService.login(formData.email, formData.password);\n\n      if (response.success) {\n        console.log('Connexion réussie, redirection vers dashboard');\n        navigate('/dashboard');\n      } else {\n        console.log('Échec de connexion:', response.message);\n        setError(response.message || 'Erreur de connexion');\n      }\n    } catch (err) {\n      console.error('Erreur lors de la connexion:', err);\n      setError(err.non_field_errors?.[0] || err.detail || err.message || 'Erreur de connexion');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-vh-100 d-flex align-items-center bg-light\">\n      <div className=\"container\">\n        <div className=\"row justify-content-center\">\n          <div className=\"col-md-6 col-lg-4\">\n            <div className=\"card shadow\">\n              <div className=\"card-body p-4\">\n                <div className=\"text-center mb-4\">\n                  <h2 className=\"card-title\">\n                    <i className=\"fas fa-user-circle text-primary me-2\"></i>\n                    Connexion\n                  </h2>\n                  <p className=\"text-muted\">Accédez à votre espace client</p>\n                </div>\n\n                {error && (\n                  <div className=\"alert alert-danger\" role=\"alert\">\n                    <i className=\"fas fa-exclamation-triangle me-2\"></i>\n                    {error}\n                  </div>\n                )}\n\n                <form onSubmit={handleSubmit}>\n                  <div className=\"mb-3\">\n                    <label htmlFor=\"email\" className=\"form-label\">\n                      <i className=\"fas fa-envelope me-2\"></i>\n                      Email\n                    </label>\n                    <input\n                      type=\"email\"\n                      className=\"form-control\"\n                      id=\"email\"\n                      name=\"email\"\n                      value={formData.email}\n                      onChange={handleChange}\n                      required\n                      placeholder=\"votre@email.com\"\n                    />\n                  </div>\n\n                  <div className=\"mb-3\">\n                    <label htmlFor=\"password\" className=\"form-label\">\n                      <i className=\"fas fa-lock me-2\"></i>\n                      Mot de passe\n                    </label>\n                    <input\n                      type=\"password\"\n                      className=\"form-control\"\n                      id=\"password\"\n                      name=\"password\"\n                      value={formData.password}\n                      onChange={handleChange}\n                      required\n                      placeholder=\"Votre mot de passe\"\n                    />\n                  </div>\n\n                  <button\n                    type=\"submit\"\n                    className=\"btn btn-primary w-100 mb-3\"\n                    disabled={loading}\n                  >\n                    {loading ? (\n                      <>\n                        <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n                        Connexion...\n                      </>\n                    ) : (\n                      <>\n                        <i className=\"fas fa-sign-in-alt me-2\"></i>\n                        Se connecter\n                      </>\n                    )}\n                  </button>\n                </form>\n\n                <div className=\"text-center\">\n                  <p className=\"mb-0\">\n                    Pas encore de compte ?{' '}\n                    <Link to=\"/register\" className=\"text-decoration-none\">\n                      S'inscrire\n                    </Link>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}